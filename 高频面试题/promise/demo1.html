<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>demo1</title>
</head>

<body>





    <script>
        // console.log('开始');
        // setTimeout(() => {
        //     console.log('买菜');
        //     setTimeout(() => {
        //         console.log('切菜');
        //         setTimeout(() => {
        //             console.log('洗菜');
        //             setTimeout(() => {
        //                 console.log('做菜');
        //             }, 2000)
        //         }, 2000)
        //     }, 1000)
        // }, 2000)

        // const p = new Promise((res, rej) => {

        //     if (true) { //如果成功 调用resolve
        //         res(value)
        //     } else { //如果失败 调用rejected
        //         rej(error)
        //     }

        // })


        // function cook(stage) {
        //     return new Promise((resolve) => {
        //         setTimeout(() => {
        //             resolve(stage)
        //         }, 2000)
        //     })
        // }






        // console.log('开始');

        // cook('买菜').then((value) => {
        //     console.log(value);
        // })


        // const p = new Promise((res, rej) => {
        //     setTimeout(() => {
        //         // rej('穷,一个人凉快去吧')
        //         res('富,迎娶白富美')
        //     }, 2 * 1000)
        // })

        // p.then((value) => {
        //     console.log(value);
        // }, error => {
        //     console.log(error);
        // })

        // function cook(statge) {
        //     return new Promise((resolve) => {
        //         setTimeout(() => {
        //             resolve(statge)
        //         }, 1000)
        //     })
        // }

        // cook('买菜').then(res => {
        //     console.log(res);
        //     return cook('洗菜')
        // }).then(res => {
        //     console.log(res);
        // })


        // const p = new Promise((res, rej) => {
        //     setTimeout(() => {
        //         // res('成功')
        //         rej('失败')
        //     }, 1000)
        // })


        // p.then(value => {
        //     console.log(value);
        // }).catch(err => {
        //     console.log(err);
        // }).finally(() => {
        //     console.log('始终会执行的代码');
        // })


        //Promise()的静态方法 通过构造函数名称(类名称)来访问的方法 resolve reject all race


        // const p = Promise.all([p1, p2, p3]);

        //延迟打印
        // function delayPrint(data, time) {
        //     return new Promise((res, rej) => {
        //         setTimeout(() => {
        //             res(data)
        //         }, time)
        //     })
        // }

        // const p1 = delayPrint('I ', 2000)
        // const p2 = delayPrint('like ', 500)
        // const p3 = delayPrint('money', 1000)

        // Promise.all([p1, p2, p3]).then(allData => {
        //     console.log(allData);
        // })


        //Promise的应用
        // function loadImage(imgUrl){
        //     return new Promise((res,rej)=>{
        //         const image=new Image()
        //         image.onload=res
        //         image.onerror=rej
        //         image.src=imgUrl
        //     })
        // }

        // loadImage('xxx.png').then(()=>{}).catch(()=>{})

        // setTimeout(() => {
        //     console.log(1)
        // }, 0)


        // Promise.resolve().then(() => {
        //     console.log(2)
        // })


        // new Promise((res) => {
        //     res(5)
        //     console.log(3)
        // }).then(n => {
        //     console.log(n);
        // })

        // console.log(4);

        //第一种方法 Async + Await +Promise
        //第二种方案 生成器函数 + yield + Promise

        (async function() {
            for (let i = 0; i < 5; i++) {
                const n = await delay(i)
                console.log(n);
            }
        })()


        function delay(n) {
            return new Promise(res => {
                setTimeout(() => {
                    res(n)
                }, 1000)
            })
        }


        // function* gen() {
        //     for (let i = 0; i < 5; i++) {
        //         const n = yield delay(i)
        //         console.log(n);
        //     }
        // }

        // function co(gen) {
        //     const g = gen()
        //     next()

        //     function next(data) {
        //         const {
        //             value,
        //             done
        //         } = g.next(data)
        //         if (done) return
        //         value.then(data => next(data))
        //     }
        // }

        // co(gen)
    </script>













</body>

</html>